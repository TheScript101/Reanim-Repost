-- // Executor GUI: R6 Animator with Reanim Tool Toggle //

-- ✅ Settings & Notification
local player = game.Players.LocalPlayer
local backpack = player:FindFirstChild("Backpack") or player:WaitForChild("Backpack")

pcall(function()
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Limb Reanim V2",
        Text = "ENJOY!",
        Icon = "rbxthumb://type=Asset&id=13775452736&w=150&h=150"
    })
    task.wait(1)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "gOb scripts",
        Text = "Edit of original with extras. Not original!",
        Icon = "rbxthumb://type=Asset&id=126389658690593&w=150&h=150"
    })
end)

-- ✅ Reanim Settings
local settings = getgenv()
settings["Use default animations"] = true
settings["Fake character transparency level"] = 1
settings["Disable character scripts"] = true
settings["Fake character should collide"] = true
settings["Parent real character to fake character"] = false
settings["Respawn character"] = true
settings["Instant respawn"] = false
settings["Hide HumanoidRootPart"] = false
settings["PermaDeath fake character"] = false
settings["Names to exclude from transparency"] = {}

-- ✅ Reanim Script Load
spawn(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/TheScript101/Reanim-Repost/refs/heads/main/CharacterReanim"))()
end)

-- ✅ Tool Data
local tools = {
    {
        Name = "The Hero",
        Mp3Url = "https://github.com/gObl00x/Epik-Musics/raw/refs/heads/main/The%20Hero.mp3",
        AnimationId = 133160365635320
    }
}

-- ✅ GUI Setup
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "R6AnimatorGui"

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 400, 0, 250)
main.Position = UDim2.new(0.5, -200, 0.5, -125)
main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
main.BorderSizePixel = 0
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 10)

local title = Instance.new("TextLabel", main)
title.Text = "R6 Animator"
title.Font = Enum.Font.GothamBlack
title.TextSize = 24
title.TextColor3 = Color3.new(1, 1, 1)
title.Size = UDim2.new(1, -20, 0, 30)
title.Position = UDim2.new(0, 10, 0, 10)
title.BackgroundTransparency = 1

local separator = Instance.new("Frame", main)
separator.Size = UDim2.new(1, -20, 0, 2)
separator.Position = UDim2.new(0, 10, 0, 45)
separator.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
separator.BorderSizePixel = 0

local minimize = Instance.new("TextButton", main)
minimize.Size = UDim2.new(0, 30, 0, 30)
minimize.Position = UDim2.new(1, -35, 0, 5)
minimize.Text = "-"
minimize.TextColor3 = Color3.new(1, 1, 1)
minimize.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
minimize.BorderSizePixel = 0

local minimized = Instance.new("TextButton", gui)
minimized.Size = UDim2.new(0, 80, 0, 30)
minimized.Position = UDim2.new(0, 10, 0, 10)
minimized.Text = "Open"
minimized.TextColor3 = Color3.new(1, 1, 1)
minimized.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
minimized.BorderColor3 = Color3.fromRGB(80, 80, 80)
minimized.BorderSizePixel = 1
minimized.Visible = false

-- ✅ Draggable Minimized
local dragging = false
game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        minimized.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

minimized.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = minimized.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

minimize.MouseButton1Click:Connect(function()
    main.Visible = false
    minimized.Visible = true
end)
minimized.MouseButton1Click:Connect(function()
    main.Visible = true
    minimized.Visible = false
end)

-- ✅ Tool Frame
local container = Instance.new("Frame", main)
container.Position = UDim2.new(0, 10, 0, 60)
container.Size = UDim2.new(1, -20, 1, -70)
container.BackgroundTransparency = 1

local layout = Instance.new("UIListLayout", container)
layout.FillDirection = Enum.FillDirection.Horizontal
layout.SortOrder = Enum.SortOrder.Name
layout.Padding = UDim.new(0, 10)

-- ✅ Tool Functions
local function spawnTool(def)
    for _, t in ipairs(backpack:GetChildren()) do
        if t.Name == def.Name then
            t:Destroy()
        end
    end

    local tool = Instance.new("Tool")
    tool.Name = def.Name
    tool.RequiresHandle = true

    local handle = Instance.new("Part")
    handle.Name = "Handle"
    handle.Size = Vector3.new(1, 1, 1)
    handle.Transparency = 1
    handle.CanCollide = false
    handle.Anchored = false
    handle.Parent = tool

    tool.Parent = backpack

    if not isfile(def.Name .. ".mp3") then
        writefile(def.Name .. ".mp3", game:HttpGet(def.Mp3Url))
    end

    if not getgenv().Animator then
        loadstring(game:HttpGet("https://raw.githubusercontent.com/TheScript101/Reanim-Repost/refs/heads/main/Source.Lua"))()
    end

    local animation = nil
    local sound = nil

    tool.Equipped:Connect(function()
        local char = player.Character
        if not char then return end

        animation = Animator.new(char, def.AnimationId)
        animation:Play()
        animation.Stopped:Connect(function()
            animation:Play()
        end)

        sound = Instance.new("Sound")
        sound.SoundId = getcustomasset(def.Name .. ".mp3")
        sound.Volume = 2
        sound.Looped = true
        sound.Parent = char:WaitForChild("HumanoidRootPart")
        sound:Play()
    end)

    tool.Unequipped:Connect(function()
        if animation then animation:Stop() animation:Destroy() animation = nil end
        if sound then sound:Stop() sound:Destroy() sound = nil end
    end)

    local humanoid = player.Character and player.Character:FindFirstChildWhichIsA("Humanoid")
    if humanoid then
        humanoid:UnequipTools()
        task.wait(0.1)
        humanoid:EquipTool(tool)
    end
end

local function removeTool(def)
    -- Unequip if it's equipped
    local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid:UnequipTools()
    end

    -- Check backpack + character
    for _, location in ipairs({backpack, player.Character}) do
        if location then
            for _, item in ipairs(location:GetChildren()) do
                if item:IsA("Tool") and item.Name == def.Name then
                    item:Destroy()
                end
            end
        end
    end
end


-- ✅ Toggle Button Builder
for _, def in pairs(tools) do
    local btn = Instance.new("TextButton", container)
    btn.Size = UDim2.new(0, 80, 0, 40)
    btn.Text = def.Name .. " (OFF)"
    btn.Font = Enum.Font.SourceSans
    btn.TextSize = 14
    btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.BorderSizePixel = 2
    btn.BorderColor3 = Color3.fromRGB(0, 0, 0)

    local toggled = false
    btn.MouseButton1Click:Connect(function()
        toggled = not toggled
        btn.Text = def.Name .. (toggled and " (ON)" or " (OFF)")
        btn.BorderColor3 = toggled and Color3.fromRGB(0, 170, 255) or Color3.fromRGB(0, 0, 0)

        if toggled then spawnTool(def) else removeTool(def) end
    end)
end

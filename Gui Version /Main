-- // Executor GUI: R6 Animator with Reanim Tool Toggle //

-- ► SERVICES & PLAYER
local Players       = game:GetService("Players")
local StarterGui    = game:GetService("StarterGui")
local InputService  = game:GetService("UserInputService")

local player        = Players.LocalPlayer
local backpack      = player:FindFirstChild("Backpack") or player:WaitForChild("Backpack")
local activeTools   = {}

-- ► NOTIFICATIONS
pcall(function()
    StarterGui:SetCore("SendNotification", {
        Title = "Limb Reanim V2";
        Text  = "ENJOY!";
        Icon  = "rbxthumb://type=Asset&id=13775452736&w=150&h=150";
    })
    task.wait(1)
    StarterGui:SetCore("SendNotification", {
        Title = "gOb scripts";
        Text  = "Edited script with extras. NOT original!";
        Icon  = "rbxthumb://type=Asset&id=126389658690593&w=150&h=150";
    })
end)

-- ► REANIM SETTINGS & LOADER
local settings = getgenv()
settings["Use default animations"]            = true
settings["Fake character transparency level"] = 1
settings["Disable character scripts"]         = true
settings["Fake character should collide"]     = true
settings["Parent real character to fake character"] = false
settings["Respawn character"]                 = true
settings["Instant respawn"]                   = false
settings["Hide HumanoidRootPart"]             = false
settings["PermaDeath fake character"]         = false
settings["Names to exclude from transparency"]= {}

task.spawn(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/TheScript101/Reanim-Repost/refs/heads/main/CharacterReanim"))()
end)

-- ► TOOL DEFINITIONS
local toolDefs = {
    {
        Name        = "The Hero",
        Mp3Url      = "https://github.com/gObl00x/Epik-Musics/raw/refs/heads/main/The%20Hero.mp3",
        AnimationId = 133160365635320,
    }, 
    {
        Name        = "Two",
        Mp3Url      = "https://github.com/gObl00x/Epik-Musics/raw/refs/heads/main/Two.mp3",
        AnimationId = 137845929482571,
    },
    {
        Name        = "The Flop",
        Mp3Url      = "https://github.com/gObl00x/Epik-Musics/raw/refs/heads/main/The%20Flop.mp3",
        AnimationId = 84447598378239,
    },
    {
        Name        = "Club Penguin",
        Mp3Url      = "https://github.com/gObl00x/Epik-Musics/raw/refs/heads/main/Club%20Penguin.mp3",
        AnimationId = 89761302048916,
    },
-- more
}

-- ► REMOVE TOOL (fully cleans up)
local function removeTool(def)
    local data = activeTools[def.Name]
    if data then
        if data.Animation then pcall(function() data.Animation:Stop(); data.Animation:Destroy() end) end
        if data.Sound     then pcall(function() data.Sound:Stop();     data.Sound:Destroy()     end) end
        if data.Tool      then pcall(function() data.Tool:Destroy()      end) end
        activeTools[def.Name] = nil
    end
    for _, container in ipairs({backpack, player.Character}) do
        if container then
            for _, inst in ipairs(container:GetChildren()) do
                if inst:IsA("Tool") and inst.Name == def.Name then inst:Destroy() end
            end
        end
    end
end

-- ► SPAWN TOOL (and hook animation & sound)
local function spawnTool(def)
    removeTool(def)
    local tool = Instance.new("Tool")
    tool.Name           = def.Name
    tool.RequiresHandle = true
    local handle = Instance.new("Part")
    handle.Name         = "Handle"
    handle.Size         = Vector3.new(1,1,1)
    handle.Transparency = 1
    handle.CanCollide   = false
    handle.Parent       = tool
    tool.Parent = backpack
    if not isfile(def.Name .. ".mp3") then
        writefile(def.Name .. ".mp3", game:HttpGet(def.Mp3Url))
    end
    if not getgenv().Animator then
        loadstring(game:HttpGet("https://raw.githubusercontent.com/TheScript101/Reanim-Repost/refs/heads/main/Source.Lua"))()
    end
    activeTools[def.Name] = { Tool = tool, Animation = nil, Sound = nil }
    tool.Equipped:Connect(function()
        local char = player.Character
        if not char then return end
        local anim = Animator.new(char, def.AnimationId)
        anim:Play()
        anim.Stopped:Connect(function() anim:Play() end)
        local snd = Instance.new("Sound")
        snd.SoundId   = getcustomasset(def.Name .. ".mp3")
        snd.Volume    = 2
        snd.Looped    = true
        snd.Parent    = char:WaitForChild("HumanoidRootPart")
        snd:Play()
        activeTools[def.Name].Animation = anim
        activeTools[def.Name].Sound     = snd
    end)
    tool.Unequipped:Connect(function()
        local data = activeTools[def.Name]
        if data and data.Animation then data.Animation:Stop(); data.Animation:Destroy(); data.Animation = nil end
        if data and data.Sound     then data.Sound:Stop();     data.Sound:Destroy();     data.Sound = nil end
    end)
    task.spawn(function()
        task.wait(0.2)
        for _, t in ipairs(backpack:GetChildren()) do
            if t == tool then
                local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
                if hum then hum:EquipTool(tool) end
                break
            end
        end
    end)
end

-- ► GUI BUILD
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "R6AnimatorGui"

local main = Instance.new("Frame", gui)
main.Size               = UDim2.new(0, 400, 0, 250)
main.AnchorPoint        = Vector2.new(0.5, 0.5)
main.Position           = UDim2.new(0.5, 0, 0.5, 0)
main.BackgroundColor3   = Color3.fromRGB(30,30,30)
Instance.new("UICorner", main).CornerRadius = UDim.new(0,12)

local title = Instance.new("TextLabel", main)
title.Text              = "R6 Animator"
title.Font              = Enum.Font.GothamBlack
title.TextSize          = 24
title.TextColor3        = Color3.new(1,1,1)
title.BackgroundTransparency = 1
title.Size              = UDim2.new(1,-20,0,30)
title.Position          = UDim2.new(0,10,0,10)

local sep = Instance.new("Frame", main)
sep.Size                = UDim2.new(1,-20,0,2)
sep.Position            = UDim2.new(0,10,0,45)
sep.BackgroundColor3    = Color3.fromRGB(70,70,70)
sep.BorderSizePixel     = 0

local minBtn = Instance.new("TextButton", main)
minBtn.Text             = "-"
minBtn.TextColor3       = Color3.new(1,1,1)
minBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
minBtn.Size             = UDim2.new(0,30,0,30)
minBtn.Position         = UDim2.new(1,-35,0,5)
minBtn.BorderSizePixel  = 0

local mini = Instance.new("TextButton", gui)
mini.Text               = "Open"
mini.TextColor3         = Color3.new(1,1,1)
mini.BackgroundColor3   = Color3.fromRGB(45,45,45)
mini.BorderColor3       = Color3.fromRGB(80,80,80)
mini.Size               = UDim2.new(0,80,0,30)
mini.Position           = UDim2.new(0,10,0,10)
mini.Visible            = false

-- Draggable mini
do
    local dragging, dragStart, startPos = false
    InputService.InputChanged:Connect(function(i)
        if dragging and i.UserInputType==Enum.UserInputType.MouseMovement then
            local d = i.Position - dragStart
            mini.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + d.X,
                                      startPos.Y.Scale, startPos.Y.Offset + d.Y)
        end
    end)
    mini.InputBegan:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 then
            dragging=true; dragStart=i.Position; startPos=mini.Position
            i.Changed:Connect(function()
                if i.UserInputState==Enum.UserInputState.End then dragging=false end
            end)
        end
    end)
end

minBtn.MouseButton1Click:Connect(function() main.Visible=false; mini.Visible=true end)
mini.MouseButton1Click:Connect(function() main.Visible=true; mini.Visible=false end)

local container = Instance.new("Frame", main)
container.Size               = UDim2.new(1,-20,1,-70)
container.Position           = UDim2.new(0,10,0,60)
container.BackgroundTransparency = 1

local layout = Instance.new("UIListLayout", container)
layout.FillDirection = Enum.FillDirection.Horizontal
layout.SortOrder     = Enum.SortOrder.Name
layout.Padding       = UDim.new(0,10)

for _, def in ipairs(toolDefs) do
    local btn = Instance.new("TextButton", container)
    btn.Size             = UDim2.new(0,80,0,40)
    btn.Text             = def.Name .. " (OFF)"
    btn.Font             = Enum.Font.SourceSans
    btn.TextSize         = 14
    btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
    btn.TextColor3       = Color3.new(1,1,1)
    btn.BorderSizePixel  = 2
    btn.BorderColor3     = Color3.fromRGB(0,0,0)
    local on = false
    btn.MouseButton1Click:Connect(function()
        on = not on
        btn.Text = def.Name .. (on and " (ON)" or " (OFF)")
        btn.BorderColor3 = on and Color3.fromRGB(0,170,255) or Color3.fromRGB(0,0,0)
        if on then spawnTool(def) else removeTool(def) end
    end)
end
